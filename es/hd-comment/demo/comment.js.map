{"version":3,"sources":["../../../components/hd-comment/demo/comment.js"],"names":["React","Component","Vote","moment","Comment","props","replyComment","commentId","e","time","format","value","target","previousSibling","firstElementChild","replySubmit","showCommentTag","currentTarget","nextSibling","style","display","closeComment","setState","info","maxLength","parentNode","showCommentAll","mergeComment","voteClick","val","state","isVote","data","author","avatar","creationDate","content","like","dislike","children","componentDidMount","UNSAFE_componentWillReceiveProps","nextprops","changeWords","length","slice","render","width","bind","map","item","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Vote from './vote';\nimport moment from 'moment';\nimport { Avatar, Button } from 'antd';\n\n\nclass Comment extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            maxLength: 0,\n            isVote: true,\n            info: '',\n            showCommentAll: false,\n            data: [\n                {\n                    author: \"张三\",\n                    avatar: \"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",\n                    creationDate: \"2019-08-28\",\n                    commentId: \"111\",\n                    content: \"66666666666666666667\",\n                    like: 10,\n                    dislike: 3,\n                    children: [\n                        {\n                            author: \"张三\",\n                            avatar: \"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",\n                            creationDate: \"2019-08-28\",\n                            commentId: \"222\",\n                            content: \"65345436534765537564475788758\",\n                            like: 10,\n                            dislike: 3,\n                        }\n                    ]\n                },\n                {\n                    author: \"张三\",\n                    avatar: \"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",\n                    creationDate: \"2019-08-28\",\n                    commentId: \"111\",\n                    content: \"66666666666666666667\",\n                    like: 10,\n                    dislike: 3,\n                    children: [\n                        {\n                            author: \"张三\",\n                            avatar: \"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",\n                            creationDate: \"2019-08-28\",\n                            commentId: \"222\",\n                            content: \"65345436534765537564475788758\",\n                            like: 10,\n                            dislike: 3,\n                        }\n                    ]\n                },\n            ]\n        };\n    }\n\n    componentDidMount() {\n        this.setState({\n            maxLength: this.props.maxLength,\n            isVote: this.props.isVote,\n            data: this.props.data,\n        })\n    }\n\n    UNSAFE_componentWillReceiveProps(nextprops) {\n        if (this.props != nextprops) {\n            this.setState({\n                maxLength: nextprops.maxLength,\n                isVote: nextprops.isVote,\n                data: nextprops.data\n            })\n        }\n    }\n\n    replyComment = (commentId, e) => {\n        let time = moment().format('YYYY-MM-DD HH:mm:ss');\n        let value = e.target.previousSibling.previousSibling.firstElementChild.value;\n        this.props.replySubmit(commentId, value, time);\n    }\n\n    //显示回复框\n    showCommentTag = (e) => {\n        e.currentTarget.nextSibling.style.display = 'block';\n    }\n\n    //取消回复\n    closeComment = (e) => {\n        e.target.previousSibling.firstElementChild.value = '';\n        this.setState({\n            info: `还可以输入${this.props.maxLength}个字！`\n        })\n        e.target.parentNode.style.display = 'none';\n    }\n\n    //展开评论\n    showCommentAll = () => {\n        this.setState({\n            showCommentAll: true\n        })\n    }\n    mergeComment = () => {\n        this.setState({\n            showCommentAll: false\n        })\n    }\n\n    voteClick = (val, commentId) => {\n        this.props.voteClick(val, commentId);\n    }\n\n    changeWords(e) {\n        let maxLength = this.state.maxLength;\n        let val = e.target.value;\n        let length = val.length;\n        if (length > maxLength) {\n            e.target.nextSibling.value = `不能输入超过${maxLength}个字!`;\n            e.target.value = val.slice(0, maxLength);\n        } else {\n            e.target.nextSibling.value = `还可以输入${maxLength - length}个字！`;\n        }\n    }\n\n    render() {\n        const { showCommentAll, data, maxLength, isVote } = this.state;\n        return (\n            <div className='comment-box' key={data.commentId}>\n                <div className='comment-avatar'>\n                    <Avatar src={data.avatar} alt={data.author} />\n                </div>\n                <div style={{ width: '100%' }}>\n                    <div>\n                        <span className='author-style'>{data.author ? data.author : '匿名'}</span>\n                        <span className='time-style'>{data.creationDate}</span>\n                    </div>\n                    <p className='content-style'>{data.content}</p>\n\n                    <div style={{ width: '100%' }}>\n                        {isVote ? <Vote voteClick={this.voteClick} commentId={data.commentId} like={data.like} dislike={data.dislike} /> : ''}\n                        <span onClick={this.showCommentTag.bind(this)} className='click-style'>回复</span>\n                        <div className='answer-second' >\n                            <div>\n                                <textarea maxLength={maxLength} onChange={this.changeWords.bind(this)}></textarea>\n                                <input disabled value={this.state.info} />\n                            </div>\n                            <Button onClick={this.closeComment.bind(this)}>取消</Button>\n                            <Button type=\"primary\" onClick={this.replyComment.bind(this, data.commentId)}>回复</Button>\n                        </div>\n                    </div>\n\n                    <div className='comment-reply'>\n                        {\n                            data.children ?\n                                (showCommentAll == false ?\n                                    data.children.slice(0, 3).map((item, index) =>\n                                        <div key={index}>\n                                            <div className='comment-avatar'>\n                                                <Avatar src={item.avatar} alt={item.author} />\n                                            </div>\n                                            <div>\n                                                <div>\n                                                    <span className='author-style'>{item.author ? item.author : '匿名'}</span>\n                                                    <span className='time-style'>{item.creationDate}</span>\n                                                </div>\n                                                <p className='content-style'>{item.content}</p>\n                                                {isVote ? <Vote voteClick={this.voteClick} commentId={item.commentId} like={item.like} dislike={item.dislike} /> : ''}\n                                            </div>\n                                        </div>\n                                    )\n                                    :\n                                    data.children.map((item, index) =>\n                                        <div key={index}>\n                                            <div className='comment-avatar'>\n                                                <Avatar src={item.avatar} alt={item.author} />\n                                            </div>\n                                            <div>\n                                                <div>\n                                                    <span className='author-style'>{item.author ? item.author : '匿名'}</span>\n                                                    <span className='time-style'>{item.creationDate}</span>\n                                                </div>\n                                                <p className='content-style'>{item.content}</p>\n                                                {isVote ? <Vote voteClick={this.voteClick} commentId={item.commentId} like={item.like} dislike={item.dislike} /> : ''}\n                                            </div>\n                                        </div>\n                                    )\n                                )\n                                :\n                                null\n                        }\n                        {data.children ? (data.children.length > 3\n                            ?\n                            (\n                                showCommentAll == false ? <p className='click-style' onClick={this.showCommentAll}>查看全部{data.children.length}条回复 ></p>\n                                    :\n                                    <p className='click-style' onClick={this.mergeComment}>收起</p>\n                            )\n                            :\n                            ''\n                        ) : ''\n                        }\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Comment;"],"file":"comment.js"}